name: iagno
version: 3.22.0
summary: 'Dominate the board in a classic version of Reversi'
description: |
  Iagno is a computer version of the game Reversi, a two-player strategy
  board game. The game is played with tiles that are dark on one side and
  light on the other.

  The object of Iagno is to flip as many of your opponent's tiles to your
  color as possible while preventing your opponent from flipping your tiles
  to his color. This is done by trapping your opponent's tiles between two
  tiles of your own color.

grade: stable # must be 'stable' to release into candidate/stable channels
confinement: strict
base: core18

plugs:
  gnome-3-28-1804:
    interface: content
    target: $SNAP/gnome-platform
    default-provider: gnome-3-28-1804
  gtk-3-themes:
    interface: content
    target: $SNAP/data-dir/themes
    default-provider: gtk-common-themes
  icon-themes:
    interface: content
    target: $SNAP/data-dir/icons
    default-provider: gtk-common-themes
  sound-themes:
    interface: content
    target: $SNAP/data-dir/sounds
    default-provider: gtk-common-themes

slots:
  # for GtkApplication registration
  iagno:
    interface: dbus
    bus: session
    name: org.gnome.iagno

apps:
  iagno:
    command: desktop-launch iagno
    plugs:
      - desktop
      - desktop-legacy
      - gsettings
      - network
      - pulseaudio
      - unity7
      - wayland
    desktop: usr/share/applications/iagno.desktop

parts:
  libcanberra:
    source: git://git.0pointer.de/libcanberra
    source-type: git
    plugin: autotools
    configflags:
      - --prefix=/snap/iagno/current/usr
      - --enable-pulse
      - --enable-gstreamer
      - --enable-gtk3
      - --enable-alsa
      - --disable-oss
    organize:
      snap/iagno/current/usr: usr
    build-packages:
      - libltdl-dev
      - libasound2-dev
      - libvorbis-dev
      - libgtk-3-dev
      - libtdb-dev
      - libpulse-dev
      - libgstreamer1.0-dev
      - gtk-doc-tools

  desktop-gnome-platform:
    source: https://github.com/ubuntu/snapcraft-desktop-helpers.git
    source-subdir: gtk
    plugin: make
    make-parameters: ["FLAVOR=gtk3"]
    build-packages:
      - build-essential
      - libgtk-3-dev
    override-build: |
      snapcraftctl build
      mkdir -pv $SNAPCRAFT_PART_INSTALL/gnome-platform

  iagno:
    after: [desktop-gnome-platform]
    source: https://gitlab.gnome.org/GNOME/iagno.git
    source-type: git
    source-tag: 3.22.0
    plugin: autotools
    override-build: |
      sed -i.bak -e 's|=iagno$|=${SNAP}/meta/gui/iagno.png|g' data/iagno.desktop.in
      snapcraftctl build
      mkdir -p $SNAPCRAFT_PART_INSTALL/meta/gui/
      cp ../src/data/icons/hicolor/256x256/iagno.png $SNAPCRAFT_PART_INSTALL/meta/gui/
      cp data/iagno.desktop $SNAPCRAFT_PART_INSTALL/meta/gui/
    configflags: [--disable-maintainer-mode, --prefix=/snap/iagno/current/usr]
    organize:
      snap/iagno/current/usr: usr
    build-packages:
      - appstream-util
      - gnome-pkg-tools
      - intltool
      - libglib2.0-dev
      - libgtk-3-dev
      - librsvg2-dev
      - valac
      - yelp-tools

